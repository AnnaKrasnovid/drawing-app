(()=>{"use strict";var t,e=document.querySelector(".image"),n=document.querySelector(".cursor"),o=document.querySelector(".button-clear"),c=document.querySelector(".button_type_redo"),i=document.querySelector(".button_type_undo"),u=document.querySelector(".button_type_save"),r=document.querySelectorAll(".input-box"),a=document.querySelector(".input-color"),s=document.querySelector(".input-range_type_opasity"),d=document.querySelector(".input-range_type_weight"),f=document.querySelector(".input-box__option_type_color"),l=document.querySelector(".input-box__option_type_opasity"),h=document.querySelector(".input-box__option_type_weight"),p=document.querySelector(".button_type_eraser"),v=document.querySelector(".button_type_brash"),g=document.querySelectorAll(".button_tool"),b=document.querySelector(".canvas"),_=b.getContext("2d"),y=(document.querySelector(".tools"),!1),m=[],x=[],E=0,L=0,S="brash",q=10,w=100,A="#55AFE2",k="rgba(85,175,226, ".concat(w,")"),T=0,C="#ffffff";f.textContent=A,l.textContent=w+" %",h.textContent=q+" px",b.style.background=C,a.setAttribute("value",A),s.setAttribute("value",w),d.setAttribute("value",q);var P=function(){return window.innerHeight-2*e.offsetTop},I=function(){return e.offsetWidth};function R(){b.setAttribute("width",I()),b.setAttribute("height",P()),t="ontouchstart"in window||navigator.msMaxTouchPoints,D()}function W(){y=!0}function X(){y=!1,m.push(x),x=[],T=m.length,U(),j()}function Y(t,e,n,o){_.lineWidth=n,_.lineCap="round",_.strokeStyle=o,_.lineTo(t,e),_.stroke(),_.beginPath(),_.moveTo(t,e),_.beginPath()}function H(n){if(y){t?(E=n.changedTouches[0].pageX-n.changedTouches[0].target.offsetParent.offsetLeft,L=n.changedTouches[0].pageY-n.changedTouches[0].target.offsetParent.offsetTop):(E=n.offsetX,L=n.offsetY),m=m.slice(0,T);var o="brash"===S?k:C;Y(E,L,q,o),x.push({x:E,y:L,weight:q,color:o}),(E+10>e.offsetWidth||E<=10||L+10>e.offsetHeight||L<10)&&(y=!1)}}function $(){_.clearRect(0,0,I(),P())}function z(t){var e=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n){return t+t+e+e+n+n}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);k="rgba(".concat(null==e?void 0:e.r,", ").concat(null==e?void 0:e.g,", ").concat(null==e?void 0:e.b,", ").concat(w/100,")")}function D(){$(),m.slice(0,T).forEach((function(t){t.forEach((function(t){Y(t.x,t.y,t.weight,t.color)}))}))}function F(t,e){S=e,function(t){g.forEach((function(e){e.classList.contains("button_active")&&O(e,"button_active"),M(t.currentTarget,"button_active")}))}(t),j(),"eraser"===S?r.forEach((function(t){t.classList.contains("input-box_type_weight")||M(t,"input-box_hide")})):r.forEach((function(t){t.classList.contains("input-box_type_weight")||O(t,"input-box_hide")}))}function M(t,e){t.classList.add(e)}function O(t,e){t.classList.remove(e)}function U(){0===m.length?O(u,"button-save_active"):M(u,"button-save_active")}function j(){(m.length>0||m.length===T)&&M(i,"button-action_active"),0!==m.length&&0!==T||O(i,"button-action_active")}function B(){m.length>0&&T<m.length&&M(c,"button-action_active"),m.length===T&&O(c,"button-action_active")}R(),_.save(),_.globalCompositeOperation="destination-over",_.fillStyle=C,_.fillRect(0,0,b.width,b.height),_.restore(),window.addEventListener("resize",(function(){return R()})),a.addEventListener("input",(function(t){return function(t){z(A=t.target.value),f.textContent=A}(t)})),s.addEventListener("input",(function(t){return function(t){w=t.target.value,z(A),l.textContent=w+"%"}(t)})),d.addEventListener("input",(function(t){return function(t){q=t.target.value,h.textContent=q+"px"}(t)})),o.addEventListener("click",(function(){$(),m=[],x=[],B(),j(),U()})),c.addEventListener("click",(function(){T!==m.length&&(T+=1,D(),B(),j())})),i.addEventListener("click",(function(){0!==T&&(T-=1,D(),j(),B())})),u.addEventListener("click",(function(){0!==m.length&&function(t){var e=document.createElement("a");e.setAttribute("download","Image.png");var n=t.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");e.setAttribute("href",n),e.click()}(b)})),p.addEventListener("click",(function(t){return F(t,"eraser")})),v.addEventListener("click",(function(t){return F(t,"brash")})),t?(b.addEventListener("touchstart",W),b.addEventListener("touchend",X),b.addEventListener("touchmove",(function(t){return H(t)}))):(b.addEventListener("mousedown",W),b.addEventListener("mouseup",X),b.addEventListener("mousemove",(function(t){return H(t)})),b.addEventListener("mousemove",(function(t){return function(t){n.setAttribute("style","\n    top: ".concat(t.offsetY-q/2,"px; \n    left: ").concat(t.offsetX-q/2,"px; \n    height: ").concat(q,"px;\n    width: ").concat(q,"px;\n    "))}(t)})))})();
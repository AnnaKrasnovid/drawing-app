(()=>{"use strict";var t=document.querySelector(".image"),e=document.querySelector(".button-clear"),n=document.querySelector(".button_type_redo"),o=document.querySelector(".button_type_undo"),i=document.querySelector(".button_type_save"),c=document.querySelectorAll(".input-box"),u=document.querySelector(".input-color"),r=document.querySelector(".input-range_type_opasity"),a=document.querySelector(".input-range_type_weight"),l=document.querySelector(".input-box__option_type_color"),s=document.querySelector(".input-box__option_type_opasity"),d=document.querySelector(".input-box__option_type_weight"),f=document.querySelector(".button_type_eraser"),p=document.querySelector(".button_type_brash"),v=document.querySelectorAll(".button_tool"),g=document.querySelector(".canvas"),h=g.getContext("2d"),b=!1,_=[],y=[],m=0,x=0,E="brash",L=10,S=100,q="#55AFE2",w="rgba(85,175,226, ".concat(S,")"),k=0,A="#ffffff";l.textContent=q,s.textContent=S+" %",d.textContent=L+" px",g.style.background=A,u.setAttribute("value",q),r.setAttribute("value",S),a.setAttribute("value",L);var C=function(){return window.innerHeight-2*t.offsetTop},I=function(){return t.offsetWidth};function R(){g.setAttribute("width",I()),g.setAttribute("height",C()),H()}function T(t,e,n,o){h.lineWidth=n,h.lineCap="round",h.strokeStyle=o,h.lineTo(t,e),h.stroke(),h.beginPath(),h.moveTo(t,e),h.beginPath()}function W(t){var e=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n){return t+t+e+e+n+n}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);w="rgba(".concat(null==e?void 0:e.r,", ").concat(null==e?void 0:e.g,", ").concat(null==e?void 0:e.b,", ").concat(S/100,")")}function H(){h.clearRect(0,0,I(),C()),_.slice(0,k).forEach((function(t){t.forEach((function(t){T(t.x,t.y,t.weight,t.color)}))}))}function P(){0===_.length?F(i,"button-save_active"):D(i,"button-save_active")}function $(){(_.length>0||_.length===k)&&D(o,"button-action_active"),0!==_.length&&0!==k||F(o,"button-action_active")}function z(){_.length>0&&k<_.length&&D(n,"button-action_active"),_.length===k&&F(n,"button-action_active")}function D(t,e){t.classList.add(e)}function F(t,e){t.classList.remove(e)}function O(t,e){E=e,function(t){v.forEach((function(e){e.classList.contains("button_active")&&F(e,"button_active"),D(t.currentTarget,"button_active")}))}(t),$(),"eraser"===E?c.forEach((function(t){t.classList.contains("input-box_type_weight")||D(t,"input-box_hide")})):c.forEach((function(t){t.classList.contains("input-box_type_weight")||F(t,"input-box_hide")}))}R(),h.save(),h.globalCompositeOperation="destination-over",h.fillStyle=A,h.fillRect(0,0,g.width,g.height),h.restore(),window.addEventListener("resize",(function(){return R()})),g.addEventListener("mousedown",(function(){b=!0})),g.addEventListener("mouseup",(function(){b=!1,_.push(y),y=[],k=_.length,P(),$()})),g.addEventListener("mousemove",(function(e){return function(e){if(b){_=_.slice(0,k),m=e.offsetX,x=e.offsetY;var n="brash"===E?w:A;T(m,x,L,n),y.push({x:m,y:x,weight:L,color:n}),(m+10>t.offsetWidth||m<=0||x+10>t.offsetHeight||x<10)&&(b=!1)}}(e)})),e.addEventListener("click",(function(){h.clearRect(0,0,I(),C()),_=[],y=[],z(),$(),P()})),u.addEventListener("input",(function(t){return function(t){W(q=t.target.value),l.textContent=q}(t)})),r.addEventListener("input",(function(t){return function(t){S=t.target.value,W(q),s.textContent=S+"%"}(t)})),a.addEventListener("input",(function(t){return function(t){L=t.target.value,d.textContent=L+"px"}(t)})),n.addEventListener("click",(function(){k!==_.length&&(k+=1,H(),z(),$())})),o.addEventListener("click",(function(){console.log(_.length,k),0!==k&&(k-=1,H(),$(),z())})),i.addEventListener("click",(function(){0!==_.length&&function(t){var e=document.createElement("a");e.setAttribute("download","Image.png");var n=t.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");e.setAttribute("href",n),e.click()}(g)})),f.addEventListener("click",(function(t){return O(t,"eraser")})),p.addEventListener("click",(function(t){return O(t,"brash")}))})();
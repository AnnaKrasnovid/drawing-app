(()=>{"use strict";var t,e=document.querySelector(".image"),n=document.querySelector(".tools"),o=document.querySelector(".cursor"),c=document.querySelector(".button-clear"),i=document.querySelector(".button_type_redo"),u=document.querySelector(".button_type_undo"),r=document.querySelector(".button_type_save"),a=document.querySelectorAll(".input-box"),s=document.querySelector(".input-color"),d=document.querySelector(".input-range_type_opasity"),f=document.querySelector(".input-range_type_weight"),l=document.querySelector(".input-box__option_type_color"),h=document.querySelector(".input-box__option_type_opasity"),p=document.querySelector(".input-box__option_type_weight"),g=document.querySelector(".button_type_eraser"),v=document.querySelector(".button_type_brash"),b=document.querySelectorAll(".button_tool"),_=document.querySelector(".canvas"),y=_.getContext("2d"),m=!1,x=[],E=[],L=0,w=0,S="brash",q=10,A=100,k="#55AFE2",T="rgba(85,175,226, ".concat(A,")"),C=0,P="#ffffff";l.textContent=k,h.textContent=A+" %",p.textContent=q+" px",_.style.background=P,s.setAttribute("value",k),d.setAttribute("value",A),f.setAttribute("value",q);var H=function(){return e.offsetWidth},I=function(){return window.innerWidth>767?(console.log(1),window.innerHeight-2*e.offsetTop):window.innerHeight-n.offsetHeight-60};function W(){_.setAttribute("width",H()),_.setAttribute("height",I()),console.log(I()),t="ontouchstart"in window||navigator.msMaxTouchPoints,F()}function R(){m=!0}function X(){m=!1,x.push(E),E=[],C=x.length,j(),B()}function Y(t,e,n,o){y.lineWidth=n,y.lineCap="round",y.strokeStyle=o,y.lineTo(t,e),y.stroke(),y.beginPath(),y.moveTo(t,e),y.beginPath()}function $(n){if(m){t?(L=n.changedTouches[0].pageX-n.changedTouches[0].target.offsetParent.offsetLeft,w=n.changedTouches[0].pageY-n.changedTouches[0].target.offsetParent.offsetTop):(L=n.offsetX,w=n.offsetY),x=x.slice(0,C);var o="brash"===S?T:P;Y(L,w,q,o),E.push({x:L,y:w,weight:q,color:o}),(L+10>e.offsetWidth||L<=10||w+10>e.offsetHeight||w<10)&&(m=!1)}}function z(){y.clearRect(0,0,H(),I())}function D(t){var e=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n){return t+t+e+e+n+n}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);T="rgba(".concat(null==e?void 0:e.r,", ").concat(null==e?void 0:e.g,", ").concat(null==e?void 0:e.b,", ").concat(A/100,")")}function F(){z(),x.slice(0,C).forEach((function(t){t.forEach((function(t){Y(t.x,t.y,t.weight,t.color)}))}))}function M(t,e){S=e,function(t){b.forEach((function(e){e.classList.contains("button_active")&&U(e,"button_active"),O(t.currentTarget,"button_active")}))}(t),B(),"eraser"===S?a.forEach((function(t){t.classList.contains("input-box_type_weight")||O(t,"input-box_hide")})):a.forEach((function(t){t.classList.contains("input-box_type_weight")||U(t,"input-box_hide")}))}function O(t,e){t.classList.add(e)}function U(t,e){t.classList.remove(e)}function j(){0===x.length?U(r,"button-save_active"):O(r,"button-save_active")}function B(){(x.length>0||x.length===C)&&O(u,"button-action_active"),0!==x.length&&0!==C||U(u,"button-action_active")}function G(){x.length>0&&C<x.length&&O(i,"button-action_active"),x.length===C&&U(i,"button-action_active")}W(),y.save(),y.globalCompositeOperation="destination-over",y.fillStyle=P,y.fillRect(0,0,_.width,_.height),y.restore(),window.addEventListener("resize",(function(){return W()})),s.addEventListener("input",(function(t){return function(t){D(k=t.target.value),l.textContent=k}(t)})),d.addEventListener("input",(function(t){return function(t){A=t.target.value,D(k),h.textContent=A+"%"}(t)})),f.addEventListener("input",(function(t){return function(t){q=t.target.value,p.textContent=q+"px"}(t)})),c.addEventListener("click",(function(){z(),x=[],E=[],G(),B(),j()})),i.addEventListener("click",(function(){C!==x.length&&(C+=1,F(),G(),B())})),u.addEventListener("click",(function(){0!==C&&(C-=1,F(),B(),G())})),r.addEventListener("click",(function(){0!==x.length&&function(t){var e=document.createElement("a");e.setAttribute("download","Image.png");var n=t.toDataURL("image/png").replace(/^data:image\/png/,"data:application/octet-stream");e.setAttribute("href",n),e.click()}(_)})),g.addEventListener("click",(function(t){return M(t,"eraser")})),v.addEventListener("click",(function(t){return M(t,"brash")})),t?(_.addEventListener("touchstart",R),_.addEventListener("touchend",X),_.addEventListener("touchmove",(function(t){return $(t)}))):(_.addEventListener("mousedown",R),_.addEventListener("mouseup",X),_.addEventListener("mousemove",(function(t){return $(t)})),_.addEventListener("mousemove",(function(t){return function(t){o.setAttribute("style","\n    top: ".concat(t.offsetY-q/2,"px; \n    left: ").concat(t.offsetX-q/2,"px; \n    height: ").concat(q,"px;\n    width: ").concat(q,"px;\n    "))}(t)})))})();